<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StatisticsDAO">

	<select id="statisticsDateList" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
		TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD') AND ML.user_id = #{user_id}
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="monthDataList" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYMM'),(LEVEL - 1)), 'YYYYMM') AS SDAY 
		FROM 
			DUAL
		CONNECT BY ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYYYMM'),(LEVEL - 1)) &lt;= TO_DATE(REPLACE(#{end_dt},'-',''), 'YYYYMM')
	) SUB
	LEFT JOIN
	(
		<foreach collection="date_list" item="item"  index="index" >
	        SELECT * FROM MSG_LOG_${item.yyyymm}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMM')
		and ml.user_id = #{user_id}		
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ml.WORK_SEQ = #{work_seq}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="yearDataList" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(LEVEL, 'YYYY'), 'YYYY') AS SDAY
		FROM 
			DUAL
		WHERE 
			LEVEL >= #{start_dt} 
		CONNECT BY LEVEL &lt;= TO_NUMBER(TO_CHAR(TO_DATE(#{end_dt},'YYYY'), 'YYYY'))
	) SUB
	LEFT JOIN
	(
		<foreach collection="table_list" item="item">
	        SELECT * FROM ${item.tname}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYY')
		and ml.user_id = #{user_id}
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ml.WORK_SEQ = #{work_seq}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="tabelList" parameterType="object" resultType="egovframework.com.msg.sta.service.TableEntity">
		SELECT 
			TNAME
		FROM 
			TAB
		WHERE
			<foreach collection="date_list" item="item">
		       TNAME LIKE 'MSG_LOG_${item.yyyy}%'
		        <if test="date_list_size != item.size">
				OR
		        </if>
		    </foreach>
	</select>
	
	<select id="partDailystatistics" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
		TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
		    AND ML.WORK_SEQ = #{work_seq}
		</if>
		 <if test="user_id != null and !user_id.equals(''.toString())">
			    AND ML.USER_ID = #{user_id}
			</if>
		LEFT JOIN COMTNEMPLYRINFO C 
	         ON ML.USER_ID = C.EMPLYR_ID 
	         and C.ORGNZT_ID =  #{orgnztId}
	GROUP BY
		SUB.SDAY
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="partMonthstatistics" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYMM'),(LEVEL - 1)), 'YYYYMM') AS SDAY 
		FROM 
			DUAL
		CONNECT BY ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYYYMM'),(LEVEL - 1)) &lt;= TO_DATE(REPLACE(#{end_dt},'-',''), 'YYYYMM')
	) SUB
	LEFT JOIN
	(
		<foreach collection="date_list" item="item"  index="index" >
	        SELECT * FROM MSG_LOG_${item.yyyymm}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMM')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
		    AND ML.WORK_SEQ = #{work_seq}
		</if>
		 <if test="user_id != null and !user_id.equals(''.toString())">
			    AND ML.USER_ID = #{user_id}
			</if>
	LEFT JOIN COMTNEMPLYRINFO C 
         ON ML.USER_ID = C.EMPLYR_ID 
         and C.ORGNZT_ID =  #{orgnztId}
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="partYearStatistics" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(LEVEL, 'YYYY'), 'YYYY') AS SDAY
		FROM 
			DUAL
		WHERE 
			LEVEL >= #{start_dt} 
		CONNECT BY LEVEL &lt;= TO_NUMBER(TO_CHAR(TO_DATE(#{end_dt},'YYYY'), 'YYYY'))
	) SUB
	LEFT JOIN
	(
		<foreach collection="table_list" item="item">
	        SELECT * FROM ${item.tname}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYY')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
		    AND ML.WORK_SEQ = #{work_seq}
		</if>
		 <if test="user_id != null and !user_id.equals(''.toString())">
			    AND ML.USER_ID = #{user_id}
			</if>
	LEFT JOIN COMTNEMPLYRINFO C 
         ON ML.USER_ID = C.EMPLYR_ID 
         and C.ORGNZT_ID =  #{orgnztId}
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngDailystatistics" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
		TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngMonthStatistics" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYMM'),(LEVEL - 1)), 'YYYYMM') AS SDAY 
		FROM 
			DUAL
		CONNECT BY ADD_MONTHS(TO_DATE(REPLACE(#{start_dt},'-',''), 'YYYYMM'),(LEVEL - 1)) &lt;= TO_DATE(REPLACE(#{end_dt},'-',''), 'YYYYMM')
	) SUB
	LEFT JOIN
	(
		<foreach collection="date_list" item="item"  index="index" >
	        SELECT * FROM MSG_LOG_${item.yyyymm}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMM')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngYearStatistics" parameterType="object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
   	SELECT
		SUB.SDAY AS "currentDay",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(LEVEL, 'YYYY'), 'YYYY') AS SDAY
		FROM 
			DUAL
		WHERE 
			LEVEL >= #{start_dt} 
		CONNECT BY LEVEL &lt;= TO_NUMBER(TO_CHAR(TO_DATE(#{end_dt},'YYYY'), 'YYYY'))
	) SUB
	LEFT JOIN
	(
		<foreach collection="table_list" item="item">
	        SELECT * FROM ${item.tname}
	        <if test="date_list_size != item.size">
			UNION
	        </if>
	    </foreach>
	) ML
	ON
		SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYY')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	GROUP BY
		SUB.SDAY
	ORDER  BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngStatisticsbyjob" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
    	ML.work_seq as "work_seq",
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		and ML.work_seq is not null
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	GROUP BY
		ML.work_seq
	ORDER BY
		ML.work_seq ASC
	</select>
	
	<select id="partStatisticsbyjobSearch" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
    	ML.work_seq as "work_seq",
    	(
			SELECT 
				code_nm 
			FROM 
				COMTCCMMNDETAILCODE 
			WHERE 
				use_at = 'Y' 
			    AND CODE_ID = 'COM003'
			    AND CODE = ML.WORK_SEQ
		) AS workNm,
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		 <if test="user_id != null and !user_id.equals(''.toString())">
			    AND ML.USER_ID = #{user_id}
			</if>
		LEFT JOIN COMTNEMPLYRINFO C ON ML.USER_ID = C.EMPLYR_ID 
    	and C.ORGNZT_ID =  #{orgnztId}
    	WHERE 
    		ML.work_seq is not null
    	<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	GROUP BY
		ML.work_seq
	ORDER BY
		ML.work_seq ASC
	</select>
	
	<select id="mngStatisticsbytypeSms" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
    	TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
        ML.MSG_PAY_CODE as "msgPayCode",
        COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	WHERE
		ML.MSG_PAY_CODE = 'SMS' or ML.MSG_PAY_CODE = 'LMS' or ML.MSG_PAY_CODE = 'MMS'
	GROUP BY
		SUB.SDAY, ML.MSG_PAY_CODE
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngStatisticsbytypeAls" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
    	TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
        ML.MSG_PAY_CODE as "msgPayCode",
        COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	WHERE ML.MSG_PAY_CODE = 'NOT'
	GROUP BY
		SUB.SDAY, ML.MSG_PAY_CODE
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngStatisticsbytypeFls" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
    SELECT 
    	TO_CHAR(TO_DATE(SUB.SDAY, 'YYMMDD'), 'MM.DD') AS "currentDay",
        ML.MSG_PAY_CODE as "msgPayCode",
        COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
		<if test="part_id != null and !part_id.equals(''.toString())">
			AND ML.USER_PART = #{part_id}
		</if>
		<if test="user_id != null and !user_id.equals(''.toString())">
			AND ML.USER_ID = #{user_id}
		</if>
	WHERE ML.MSG_PAY_CODE = 'FRT' or ML.MSG_PAY_CODE = 'FIT'
	GROUP BY
		SUB.SDAY, ML.MSG_PAY_CODE
	ORDER BY
		SUB.SDAY ASC
	</select>
	
	<select id="mngStatisticsbyaltSearch" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
		SELECT 
	      ROWNUM as seq,
	      COUNT(ML.SENT_DATE) AS "total",
	      COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
	      COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",   
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
	      COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
	      TD.TEMPLATE_CODE AS tmpcode,
	      TD.TEMPLATE_NAME AS tmpname,
	      td.subject as tmpsub,
	      td.work_seq as tmpwork,
	      TD.TEMPLATE_CONTENT AS tmpcontent
	   FROM
	      TEMPLATE_DATA TD
	      LEFT JOIN MSG_LOG_${month} ML 
	         ON TD.TEMPLATE_CODE = ML.MSG_NOTICETALK_TMP_KEY 
	            AND ML.MSG_PAY_CODE = 'NOT' 
	            AND TO_DATE(#{start_dt}, 'YYYY-MM-DD')&lt;=TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD'), 'YYYY-MM-DD') 
	            AND TO_DATE(#{end_dt}, 'YYYY-MM-DD')&gt;=TO_DATE(TO_CHAR(SYSDATE, 'YYYY-MM-DD'), 'YYYY-MM-DD')
	      LEFT JOIN COMTNEMPLYRINFO C 
	         ON ML.USER_ID = C.EMPLYR_ID
		   	<if test="work_seq != null and !work_seq.equals(''.toString())">
				AND ML.WORK_SEQ = #{work_seq}
			</if>
			<if test="part_id != null and !part_id.equals(''.toString())">
				AND ML.USER_PART = #{part_id}
			</if>
			<if test="user_id != null and !user_id.equals(''.toString())">
				AND ML.USER_ID = #{user_id}
			</if>
	   GROUP BY
	      TD.TEMPLATE_CODE, TD.TEMPLATE_NAME, TD.TEMPLATE_CONTENT, C.USER_NM, td.subject, td.work_seq, ROWNUM
	   ORDER BY
	      ROWNUM ASC
	</select>
	
	<select id="mngStatisticsbypart" parameterType="Object" resultType="egovframework.com.msg.sta.service.StatisticsVO">
		SELECT 
        C.ORGNZT_ID as partId,
		COUNT(ML.SENT_DATE) AS "total",
		COUNT( CASE WHEN ML.RSLT_CODE2 = '0' THEN '0' END ) AS "totals",
		COUNT( CASE WHEN ML.RSLT_CODE2 != '0' THEN '0' END ) AS "totalf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' THEN 'SMS' END ) AS "sms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 = '0' THEN 'SMS' END ) AS "smss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'SMS' AND ML.RSLT_CODE2 != '0' THEN 'SMS' END ) AS "smsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' THEN 'LMS' END ) AS "lms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 = '0' THEN 'LMS' END ) AS "lmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'LMS' AND ML.RSLT_CODE2 != '0' THEN 'LMS' END ) AS "lmsf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' THEN 'MMS' END ) AS "mms",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 = '0' THEN 'MMS' END ) AS "mmss",
		COUNT( CASE WHEN MSG_PAY_CODE = 'MMS' AND ML.RSLT_CODE2 != '0' THEN 'MMS' END ) AS "mmsf",	
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "not",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 = '0' THEN 'NOT' END ) AS "nots",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_CODE2 != '0' THEN 'NOT' END ) AS "notf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' THEN 'NOT' END ) AS "notr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'NOT' END ) AS "notrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'NOT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'NOT' END ) AS "notrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frt",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 = '0' THEN 'FRT' END ) AS "frts",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_CODE2 != '0' THEN 'FRT' END ) AS "frtf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' THEN 'FRT' END ) AS "frtr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRT' END ) AS "frtrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRT' END ) AS "frtrf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "fri",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 = '0' THEN 'FRI' END ) AS "fris",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_CODE2 != '0' THEN 'FRI' END ) AS "frif",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' THEN 'FRI' END ) AS "frir",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FRI' END ) AS "frirs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FRI' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FRI' END ) AS "frirf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fit",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 = '0' THEN 'FIT' END ) AS "fits",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_CODE2 != '0' THEN 'FIT' END ) AS "fitf",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' THEN 'FIT' END ) AS "fitr",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT > 0 THEN 'FIT' END ) AS "fitrs",
		COUNT( CASE WHEN MSG_PAY_CODE = 'FIT' AND ML.RSLT_NET = 'ETC' AND MSG_RESEND_COUNT = 0 THEN 'FIT' END ) AS "fitrf"
	FROM(
		SELECT 
			TO_CHAR(TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+LEVEL-1,'YYYYMMDD') AS SDAY
		FROM 
		  	DUAL 
		CONNECT BY LEVEL &lt;= (TO_DATE(REPLACE(#{end_dt},'-',''),'YYYYMMDD') - TO_DATE(REPLACE(#{start_dt},'-',''),'YYYYMMDD')+1)		
		) SUB
		LEFT JOIN MSG_LOG_${month} ML ON SUB.SDAY = TO_CHAR(ML.SENT_DATE, 'YYYYMMDD')
        LEFT JOIN COMTNEMPLYRINFO C 
	         ON ML.USER_ID = C.EMPLYR_ID 
    		 and C.ORGNZT_ID is not null
		<if test="work_seq != null and !work_seq.equals(''.toString())">
			AND ML.WORK_SEQ = #{work_seq}
		</if>
	GROUP BY
		C.ORGNZT_ID
	ORDER BY
		C.ORGNZT_ID ASC
	</select>
</mapper>
